# 🚀 快速开始指南

## 📦 项目地址

**GitHub仓库：** https://github.com/six8888-cpu/weibojiankong

---

## 🎯 功能特点

✅ **反爬虫绕过** - 使用Playwright无头浏览器，绕过Cloudflare等反爬虫  
✅ **1分钟自动检查** - 每1分钟自动监控一次  
✅ **Telegram群组通知** - 检测到关键词立即发送到Telegram群组  
✅ **模糊匹配** - 支持多关键词模糊匹配  
✅ **Web管理界面** - 漂亮的Web界面，轻松管理  
✅ **开机自启** - systemd服务，服务器重启自动运行  

---

## 💻 Windows本地测试

### 方法1：双击启动（最简单）

```bash
# 双击运行
start.bat
```

访问：http://localhost:9527

### 方法2：命令行启动

```bash
# 进入项目目录
cd D:\cursor\1

# 双击 start.bat 或手动执行
.\venv\Scripts\python.exe app.py
```

---

## 🐧 Linux服务器部署

### 一键安装（推荐）

```bash
cd /opt && \
sudo git clone https://github.com/six8888-cpu/weibojiankong.git && \
sudo chown -R $USER:$USER weibojiankong && \
cd weibojiankong && \
chmod +x install.sh && \
sudo ./install.sh
```

安装时会询问是否创建systemd服务，**选择y**

### 启动服务

```bash
# 启动
sudo systemctl start web-monitor

# 开机自启
sudo systemctl enable web-monitor

# 查看状态
sudo systemctl status web-monitor

# 查看日志
sudo journalctl -u web-monitor -f
```

### 开放端口

```bash
# CentOS/RHEL
sudo firewall-cmd --permanent --add-port=9527/tcp
sudo firewall-cmd --reload

# Ubuntu/Debian
sudo ufw allow 9527/tcp
```

**访问地址：** `http://你的服务器IP:9527`

---

## 📱 配置Telegram群组通知

### 1. 创建机器人

1. 在Telegram搜索：`@BotFather`
2. 发送：`/newbot`
3. 设置名称，获取 **Bot Token**

### 2. 获取群组Chat ID

**方法1：通过API（推荐）**

1. 创建Telegram群组
2. 把机器人添加到群组
3. 在群组里@机器人发条消息
4. 浏览器访问（替换你的Token）：

```
https://api.telegram.org/bot你的BOT_TOKEN/getUpdates
```

5. 找到 `"chat":{"id":-1001234567890}`
6. 复制这个**负数ID**（包括负号）

**方法2：使用机器人**

1. 搜索 `@getidsbot` 或 `@RawDataBot`
2. 添加到群组
3. 它会显示群组Chat ID

### 3. 在Web界面配置

1. 访问Web界面
2. 点击"Telegram配置"
3. 填入：
   - Bot Token
   - Chat ID（**群组ID是负数**）
4. 点击"测试连接"
5. 检查群组是否收到消息

---

## 🎮 使用流程

### 1. 添加监控网址

- 进入"监控列表"
- 点击"添加监控网址"
- 填写：
  - 网址名称（如：微博用户）
  - 网址URL（如：https://weibo.com/u/2656274875）
  - 检查间隔（默认60秒）

### 2. 添加关键词

- 进入"关键词管理"
- 点击"添加关键词"
- 选择监控网址
- 输入关键词（如：毛线球、老鹰捉鱼）
- 选择模糊匹配（推荐）

### 3. 启动监控

- 点击顶部"启动监控"按钮
- 系统每1分钟自动检查一次
- 检测到关键词会发送Telegram通知

### 4. 查看日志

- 进入"监控日志"查看检测记录
- ✅ 绿色：检测到关键词
- ℹ️ 蓝色：未检测到

---

## 🔧 管理命令

### 查看服务状态
```bash
sudo systemctl status web-monitor
```

### 查看实时日志
```bash
sudo journalctl -u web-monitor -f
```

### 重启服务
```bash
sudo systemctl restart web-monitor
```

### 停止服务
```bash
sudo systemctl stop web-monitor
```

### 更新代码
```bash
cd /opt/weibojiankong
git pull
sudo systemctl restart web-monitor
```

---

## ⚙️ 高级配置

### 修改端口

编辑 `app.py` 最后一行：

```python
app.run(host='0.0.0.0', port=9527, debug=False)
```

改成你想要的端口，然后重启服务。

### 修改检查间隔

在Web界面的监控列表中，编辑每个URL的检查间隔。

或修改 `app.py` 中的默认值：

```python
trigger=IntervalTrigger(seconds=60)  # 改成你想要的秒数
```

---

## ❓ 常见问题

### Q: 为什么Windows能运行，Linux不行？

A: 已修复！问题是systemd服务的PATH环境变量。最新版本已包含修复。

### Q: 收不到Telegram通知？

A: 检查：
1. Bot Token和Chat ID是否正确
2. Chat ID是否包含负号（群组）
3. 机器人是否在群组中
4. 点击"测试连接"验证

### Q: 如何监控多个网址？

A: 在"监控列表"中添加多个URL，每个URL可以设置不同的关键词。

### Q: 关键词区分大小写吗？

A: 不区分！系统会转为小写匹配。

### Q: 可以同时用多个关键词吗？

A: 可以！每个URL可以添加多个关键词，任意一个匹配就会通知。

---

## 🎉 完成！

现在你的微博监控系统已经成功部署了！

**本地测试：** http://localhost:9527  
**服务器访问：** http://你的IP:9527

有问题查看：
- 应用日志：`/opt/weibojiankong/monitor.log`
- 服务日志：`sudo journalctl -u web-monitor -f`

---

**享受自动化监控的乐趣吧！** 🚀

